import{C as D,c as I,i as M,b as T,_ as F,d as B,u as _,a as P,B as E,I as b,h as z,g as A}from"./viewdata-a68a6e10.js";import{w as R,u as H,C as V,F as U,P as Z,r as q,O as G,a as Y,c as w,b as J,d as K,e as Q,f as X,g as y,m as ee,h as te,I as N,j as se,k as ne,l as oe,D as ae,n as O,o as re}from"./index-c8ddf319.js";import{r as m,R as h,j as s,a as ie}from"./index-02dfd380.js";import{C as le}from"./cuIcon-64538223.js";import{u as ce}from"./index-8ccf0043.js";import{C as de}from"./index-e7d53733.js";import{a as p,S}from"./Transition-a4626c3d.js";var ue=globalThis&&globalThis.__rest||function(e,t){var l={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(l[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(l[a[o]]=e[a[o]]);return l};const he=e=>{const{prefixCls:t,className:l,closeIcon:a,closable:o,type:r,title:d,children:i,footer:C}=e,n=ue(e,["prefixCls","className","closeIcon","closable","type","title","children","footer"]),{getPrefixCls:u}=m.useContext(D),x=u(),c=t||u("modal"),[,j]=H(c),v=`${c}-confirm`;let k={};return r?k={closable:o??!1,title:"",footer:"",children:m.createElement(V,Object.assign({},e,{prefixCls:c,confirmPrefixCls:v,rootPrefixCls:x,content:i}))}:k={closable:o??!0,title:d,footer:C!==null&&m.createElement(U,Object.assign({},e)),children:i},m.createElement(Z,Object.assign({prefixCls:c,className:I(j,`${c}-pure-panel`,r&&v,r&&`${v}-${r}`,l)},n,{closeIcon:q(c,a),closable:o},k))},me=R(he);function W(e){return w(te(e))}const f=G;f.useModal=Y;f.info=function(t){return w(J(t))};f.success=function(t){return w(K(t))};f.error=function(t){return w(Q(t))};f.warning=W;f.warn=W;f.confirm=function(t){return w(X(t))};f.destroyAll=function(){for(;y.length;){const t=y.pop();t&&t()}};f.config=ee;f._InternalPanelDoNotUseOrYouWillBeFired=me;const fe=f,Ce=N("asterisk",!1,function(e){return h.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},h.createElement("path",{d:"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z",fill:e.colors[1],stroke:e.colors[0],strokeWidth:e.strokeWidth,strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin}),h.createElement("path",{d:"M15 24H33",stroke:e.colors[2],strokeWidth:e.strokeWidth,strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin}),h.createElement("path",{d:"M19.5 16.2056L28.5 31.794",stroke:e.colors[2],strokeWidth:e.strokeWidth,strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin}),h.createElement("path",{d:"M28.5 16.2056L19.5 31.794",stroke:e.colors[2],strokeWidth:e.strokeWidth,strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin}))}),$=N("link-two",!0,function(e){return h.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},h.createElement("path",{d:"M30 19H20C15.5817 19 12 22.5817 12 27C12 31.4183 15.5817 35 20 35H36C40.4183 35 44 31.4183 44 27C44 24.9711 43.2447 23.1186 42 21.7084",stroke:e.colors[0],strokeWidth:e.strokeWidth,strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin}),h.createElement("path",{d:"M6 24.2916C4.75527 22.8814 4 21.0289 4 19C4 14.5817 7.58172 11 12 11H28C32.4183 11 36 14.5817 36 19C36 23.4183 32.4183 27 28 27H18",stroke:e.colors[0],strokeWidth:e.strokeWidth,strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin}))}),ke=N("tag-one",!0,function(e){return h.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},h.createElement("path",{d:"M42.1691 29.2451L29.2631 42.1511C28.5879 42.8271 27.6716 43.2069 26.7161 43.2069C25.7606 43.2069 24.8444 42.8271 24.1691 42.1511L8 26V8H26L42.1691 24.1691C43.5649 25.5732 43.5649 27.841 42.1691 29.2451Z",fill:e.colors[1],stroke:e.colors[0],strokeWidth:e.strokeWidth,strokeLinejoin:e.strokeLinejoin}),h.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.5 21C19.8807 21 21 19.8807 21 18.5C21 17.1193 19.8807 16 18.5 16C17.1193 16 16 17.1193 16 18.5C16 19.8807 17.1193 21 18.5 21Z",fill:e.colors[2]}))});function Me(e,t){var l;M&&(T(e)||console.error("useDebounceFn expected parameter is a function, got ".concat(typeof e)));var a=se(e),o=(l=t==null?void 0:t.wait)!==null&&l!==void 0?l:1e3,r=m.useMemo(function(){return ne(function(){for(var d=[],i=0;i<arguments.length;i++)d[i]=arguments[i];return a.current.apply(a,F([],B(d),!1))},o,t)},[]);return oe(function(){r.cancel()}),{run:r,cancel:r.cancel,flush:r.flush}}const xe="_novelCard_1771s_1",ve="_novelCardPeizhu_1771s_6",ge="_novelCarddiwan_1771s_14",we="_novelCardLinkBut_1771s_29",g={novelCard:xe,novelCardPeizhu:ve,novelCarddiwan:ge,novelCardLinkBut:we};function je({txt:e}){const[t,{toggle:l}]=P("nowrap","normal");if(e)return s.jsxs("div",{onClick:l,style:{whiteSpace:t},className:g.novelCardPeizhu+" singe-line mt-15",children:[s.jsx("span",{style:{color:"var(--text-color-3)"},children:"备注："}),e]})}function L({link:e}){if(e.urli)return s.jsx(E,{type:"dashed",className:g.novelCardLinkBut,icon:s.jsx($,{theme:"outline",size:"15"}),onClick:()=>{O(e.urli,t=>window.$message.success(t))},children:e.linkName})}function Le({start:e,finish:t}){return!e&&!t?null:s.jsxs("div",{className:"flex-ai-c mt-10",children:[s.jsx(Ce,{theme:"outline",size:"18",fill:"var(--success-color)",onClick:()=>click(updateChapter)}),s.jsxs("h4",{className:g.cardExtra+" ml-10",onClick:()=>click(updateChapter),children:["第 ",e||"???"," - ",t||"???"," 章"]}),s.jsx(p,{color:ie(),className:"ml-auto",children:"完结"})]})}const pe=m.memo(Le),Ne=[{key:"1",label:s.jsx("h4",{className:"text-align",children:"修改"})},{key:"2",label:s.jsx("h4",{className:"text-align",children:"删除"})}],be=e=>{const{data:t,updateChapter:l,updateDuwan:a}=e,{store:o,setValueStore:r}=ce(),{setNovelStore:d}=_(),i=m.useCallback(n=>{d({data:t}),n&&n(t)}),C=m.useCallback(async({key:n})=>{n==="1"?(r({isAddDrawer:!o.isAddDrawer}),d({action:"updata",data:t})):await window.$modal.confirm({okText:"删除",okType:"danger",maskClosable:!0,centered:!0,cancelText:"取消",title:"删除小说",content:"是否将（删除）"})&&await http.post("/react/novel/update",{_id:t._id,isdel:0}).catch(c=>(window.$message.error("删除失败"),Promise.reject(c)))&&(novelStore.novelList.splice(index,1),d({novelList:[].concat(novelStore.novelList)}),window.$message.success("删除成功"))});return s.jsxs(de,{style:e.style,className:g.novelCard,bordered:!1,hoverable:!0,title:s.jsxs("div",{className:"flex",children:[s.jsx(ae,{menu:{items:Ne,onClick:C},placement:"bottomLeft",arrow:{pointAtCenter:!0},children:s.jsx(le,{icon:"hot",size:"22",color:"var(--primary-color)",className:"mr-10"})}),s.jsx("h4",{className:"wax-100 singe-line",onClick:()=>O(t.title,n=>window.$message.success(n)),children:t.title})]}),extra:t.duwan===1?s.jsx(p,{color:"var(--success-color)",className:"ml-auto",onClick:()=>i(a),children:"读完"}):s.jsx("div",{className:g.novelCarddiwan+" ml-auto",onClick:()=>i(a)}),children:[s.jsxs("div",{className:"flex-ai-c",children:[s.jsx(ke,{theme:"outline",size:"18",fill:"var(--success-color)",className:"mr-5 el-transition-color"}),"标签：",t.tabs.map(n=>s.jsx(p,{color:n.color,className:"",children:n.tab},n.tab))]}),s.jsx(pe,{start:t.start,finish:t.finish}),s.jsxs("h4",{className:"flex-ai-c mt-10",children:[s.jsx($,{theme:"outline",size:"18",fill:"var(--success-color)",className:"mr-5"}),"链接："]}),s.jsxs(S,{size:[14,7],wrap:!0,className:"mt-10",children:[s.jsx(L,{link:{linkName:"首链接",urli:t.link}}),s.jsx(L,{link:{linkName:"后续链接",urli:t.linkback}}),(t==null?void 0:t.links)&&t.links.map((n,u)=>s.jsx(L,{link:n},u))]}),s.jsx(je,{txt:t.beizhu})]})},ye="_chapter_1q3g1_2",_e={chapter:ye},Pe=e=>{const{show:t=!1,toggle:l,change:a,id:o}=e,[r,d]=m.useState({start:"",finish:""});re(()=>{d({start:e.start??"",finish:e.finish??""})},[t]);const i=async()=>{await z.post("/react/novel/update",{_id:o,start:r.start,finish:r.finish}).catch(n=>(window.$message.error("修改失败"),Promise.reject(n)))?(a&&a(({novel:n},u)=>{const x=n.novelList.findIndex(c=>c._id===o);n.novelList[x].start=r.start,n.novelList[x].finish=r.finish,u(c=>({...c,novelList:[].concat(n.novelList)}))}),window.$message.success("修改成功")):window.$message.error("修改失败")};return s.jsxs(fe,{open:t,onOk:l,onCancel:l,centered:!0,closeIcon:!1,title:"章节修改：",footer:null,children:[s.jsxs(S.Compact,{size:"large",className:"w-100 mt-10",children:[s.jsx(b,{addonBefore:"第",placeholder:"0",className:"text-align",allowClear:!0,value:r.start,onChange:C=>d(n=>({...n,start:C.target.value}))}),s.jsx("div",{className:_e.chapter+" flex-fdc-aic-juc"}),s.jsx(b,{allowClear:!0,addonAfter:"章",placeholder:"*",className:"text-align",value:r.finish,onChange:C=>d(n=>({...n,finish:C.target.value}))})]}),s.jsx(E,{type:"primary",block:!0,className:"mt-10",onClick:i,children:"确认"})]})},Ee=()=>{const{novel:e,setNovelStore:t}=_(),[l,{toggle:a}]=P(),o=i=>t({data:i}),r=i=>{o(i),a()},d=i=>{i&&i(A(),t)};return{show:l,toggle:a,data:e.data,setData:o,updateNovelList:d,toggleOnSetData:r}},Te=({data:e})=>{const{show:t,toggle:l,toggleOnSetData:a,data:o,updateNovelList:r}=Ee(),d=m.useCallback(a),i=async n=>{const u=+!n.duwan;await z.post("/mong/novel/update",{_id:n._id,duwan:u})?r(({novel:c},j)=>{const v=c.novelList.findIndex(k=>k._id===n._id);c.novelList[v].duwan=u,j(k=>({...k,novelList:[].concat(c.novelList)})),setTimeout(()=>{c.novelList[v]},1e3)}):window.$message.error("失败")},C=m.useMemo(()=>!Array.isArray(e)||!e.length?null:e.map((n,u)=>s.jsx(be,{data:n,updateChapter:d,updateDuwan:i},n._id)),[e]);return s.jsxs(s.Fragment,{children:[C,s.jsx(Pe,{show:t,toggle:l,start:o.start,finish:o.finish,change:r,id:o._id})]})};export{Te as N,Me as u};
