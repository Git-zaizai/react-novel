import{j as e}from"./index-02dfd380.js";import{C as g}from"./cuIcon-64538223.js";import{V as w}from"./index-a84733ef.js";import{a as p,u as x,I as m,B as h,h as i}from"./viewdata-a68a6e10.js";import{F as t}from"./index-f7e32f2a.js";import"./index-e7d53733.js";const f="_view_1c0u6_1",y="_circleCard_1c0u6_6",j="_RadioButtonIcontag_1c0u6_10",_="_RadioButtonIconmedal_1c0u6_14",c={view:f,circleCard:y,RadioButtonIcontag:j,RadioButtonIconmedal:_},{TextArea:I}=m,$=()=>{const[s]=t.useForm(),[l,{toggle:n}]=p(),{tabs:d}=x(),u=async a=>{n();try{if(d.includes(a.name)){window.$message.warning(`已有 ${a.anme} ${a.type?"记录类型":"标签"}`);return}if((await i.post("/curd-mongo/find/tabs",{where:{name:a.name}})).length){window.$message.warning(`已有 ${a.anme} 的申请记录`);return}const o=await i.post("/curd-mongo/add/tabs",{data:{type:a.type,name:a.name,txt:a.txt,reply:"",adddate:new Date}});o!=null&&o.acknowledged&&(window.$message.success("提交申请成功"),s.setFieldsValue({type:1,name:"",txt:""}))}catch(r){window.$message.error("申请失败"),console.log(r)}finally{setTimeout(()=>{n()},1e3)}};return e.jsx("div",{className:c.view,children:e.jsx(w,{className:c.circleCard,title:e.jsxs("div",{className:"flex",children:[e.jsx(g,{icon:"tag",size:"22",color:"var(--primary-color)",className:"mr-10"}),e.jsx("h4",{className:"wax-100 singe-line",children:"标签添加申请"})]}),children:e.jsxs(t,{form:s,onFinish:u,initialValues:{type:1},children:[e.jsx(t.Item,{name:"name",rules:[{required:!0,message:"不能为空"}],validateTrigger:"onBlur",children:e.jsx(m,{placeholder:"记录类型与标签 名",allowClear:!0})}),e.jsx(t.Item,{name:"txt",validateTrigger:"onBlur",children:e.jsx(I,{allowClear:!0,placeholder:"说明",autoSize:{minRows:2,maxRows:7}})}),e.jsx(h,{type:"primary",htmlType:"submit",className:"mt-5",block:!0,loading:l,children:"提交"})]})})})};export{$ as default};
